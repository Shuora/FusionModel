2026-02-14 10:55:25,600 - INFO - train_attention_stacking - 运行 ID: 20260214_105525
2026-02-14 10:55:25,600 - INFO - train_attention_stacking - 训练设备: cuda:0
2026-02-14 10:55:25,601 - INFO - train_attention_stacking - 训练参数: {"dataset_root": "dataset/USTC_10", "dataset_name": "", "batch_size": 32, "image_size": 28, "char_seq_len": 786, "epochs": 30, "lr": 0.001, "weight_decay": 0.0001, "label_smoothing": 0.0, "patience": 8, "early_stop_metric": "val_f1", "optimizer": "adamw", "lr_scheduler": "none", "lr_patience": 2, "lr_factor": 0.5, "min_lr": 1e-06, "grad_clip_norm": 0.0, "class_balance": "none", "loss_type": "ce", "focal_gamma": 2.0, "attention_dim": 256, "dropout": 0.3, "xgb_estimators": 300, "xgb_max_depth": 6, "xgb_lr": 0.05, "num_workers": 4, "pin_memory": false, "device": "auto", "seed": 42, "no_amp": false, "ablation": "none", "no_index_cache": false, "rebuild_index_cache": false, "output_dir": "outputs/train", "run_name": ""}
2026-02-14 10:55:25,602 - INFO - train_common - 加载数据集: USTC_10
2026-02-14 10:55:25,602 - INFO - train_common - 训练目录 image=C:\Repositories\Traffic\FusionModel\dataset\USTC_10\image_data\Train pcap=C:\Repositories\Traffic\FusionModel\dataset\USTC_10\pcap_data\Train
2026-02-14 10:55:25,602 - INFO - train_common - 验证目录 image=C:\Repositories\Traffic\FusionModel\dataset\USTC_10\image_data\Test pcap=C:\Repositories\Traffic\FusionModel\dataset\USTC_10\pcap_data\Test
2026-02-14 10:55:25,740 - INFO - train_common - DataLoader 参数: batch_size=32 num_workers=4 pin_memory=True
2026-02-14 10:55:25,740 - INFO - train_common - 训练样本=52375 验证样本=19396 类别数=10
2026-02-14 10:55:25,740 - INFO - train_common - 训练集类别分布: Cridex:8196, Geodo:4977, Htbot:4705, Miuref:3967, Neris:5196, Nsis-ay:4819, Shifu:7655, Tinba:6803, Virut:2584, Zeus:3473
2026-02-14 10:55:25,740 - INFO - train_common - 验证集类别分布: Cridex:1642, Geodo:1712, Htbot:1246, Miuref:984, Neris:3232, Nsis-ay:1214, Shifu:1920, Tinba:1700, Virut:3555, Zeus:2191
2026-02-14 10:55:25,741 - INFO - train_attention_stacking - 数据集=USTC_10 类别数=10 训练样本=52375 验证样本=19396
2026-02-14 10:55:26,101 - INFO - train_attention_stacking - 模型参数量: total=922110 trainable=922110
2026-02-14 10:55:27,242 - INFO - train_common - 开始训练: epochs=30 patience=8 early_stop_metric=val_f1 use_amp=True scheduler=none grad_clip_norm=0.0
2026-02-14 10:57:32,529 - INFO - train_common - 保存最佳模型: C:\Repositories\Traffic\FusionModel\outputs\train\20260214_105525\checkpoints\best.pt (epoch=1, val_f1=0.743807)
2026-02-14 10:57:32,533 - INFO - train_common - Epoch 1/30 结果: 训练 Loss=0.234079 Acc=0.9195 F1=0.8964 | 验证 Loss=1.131388 Acc=0.6806 F1=0.7438 | best_val_f1=0.743807 wait=0/8 耗时=125.0s
2026-02-14 10:57:32,533 - INFO - train_common - 当前学习率: 0.00100000
2026-02-14 10:59:40,510 - INFO - train_common - Epoch 2/30 结果: 训练 Loss=0.112196 Acc=0.9596 F1=0.9454 | 验证 Loss=2.049771 Acc=0.6543 F1=0.7120 | best_val_f1=0.743807 wait=1/8 耗时=127.8s
2026-02-14 10:59:40,511 - INFO - train_common - 当前学习率: 0.00100000
2026-02-14 11:02:10,691 - INFO - train_common - Epoch 3/30 结果: 训练 Loss=0.093511 Acc=0.9663 F1=0.9542 | 验证 Loss=1.773557 Acc=0.6445 F1=0.7176 | best_val_f1=0.743807 wait=2/8 耗时=150.1s
2026-02-14 11:02:10,691 - INFO - train_common - 当前学习率: 0.00100000
2026-02-14 11:03:58,744 - INFO - train_common - 保存最佳模型: C:\Repositories\Traffic\FusionModel\outputs\train\20260214_105525\checkpoints\best.pt (epoch=4, val_f1=0.745234)
2026-02-14 11:03:58,744 - INFO - train_common - Epoch 4/30 结果: 训练 Loss=0.087804 Acc=0.9674 F1=0.9559 | 验证 Loss=1.185716 Acc=0.6980 F1=0.7452 | best_val_f1=0.745234 wait=0/8 耗时=108.0s
2026-02-14 11:03:58,744 - INFO - train_common - 当前学习率: 0.00100000
2026-02-14 11:05:38,537 - INFO - train_common - Epoch 5/30 结果: 训练 Loss=0.075654 Acc=0.9718 F1=0.9615 | 验证 Loss=1.202011 Acc=0.6907 F1=0.7365 | best_val_f1=0.745234 wait=1/8 耗时=99.6s
2026-02-14 11:05:38,538 - INFO - train_common - 当前学习率: 0.00100000
2026-02-14 11:09:12,728 - INFO - train_common - Epoch 6/30 结果: 训练 Loss=0.067985 Acc=0.9739 F1=0.9642 | 验证 Loss=1.665623 Acc=0.6465 F1=0.6962 | best_val_f1=0.745234 wait=2/8 耗时=214.1s
2026-02-14 11:09:12,728 - INFO - train_common - 当前学习率: 0.00100000
2026-02-14 11:11:56,205 - INFO - train_common - Epoch 7/30 结果: 训练 Loss=0.064312 Acc=0.9755 F1=0.9663 | 验证 Loss=1.632448 Acc=0.6592 F1=0.6891 | best_val_f1=0.745234 wait=3/8 耗时=163.3s
2026-02-14 11:11:56,206 - INFO - train_common - 当前学习率: 0.00100000
