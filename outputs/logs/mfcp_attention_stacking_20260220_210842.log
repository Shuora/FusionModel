2026-02-20 21:08:42,234 - INFO - run_mfcp_attention_stacking - ğŸš€ å¼€å§‹ stacking: base=attention, outputs=C:\Repositories\Traffic\FusionModel\outputs
2026-02-20 21:08:42,234 - INFO - fusion_common - åŠ è½½èåˆæ•°æ® - å›¾åƒç›®å½•: C:\Repositories\Traffic\FusionModel\dataset\mfcp\image_data\Train, Pcapç›®å½•: C:\Repositories\Traffic\FusionModel\dataset\mfcp\pcap_data\Train
2026-02-20 21:08:42,286 - INFO - fusion_common - èåˆç´¢å¼•ç¼“å­˜å‘½ä¸­: C:\Repositories\Traffic\FusionModel\dataset\mfcp\image_data\Train\.fusion_index_cache_v2_crepositoriestrafficfusionmo_crepositoriestrafficfusionmo.json, æ ·æœ¬æ•°: 44977
2026-02-20 21:08:42,292 - INFO - fusion_common - ç±»åˆ«åˆ†å¸ƒ(Train) - Artemis:8236, Cobalt:934, Dridex:4021, PUA:1439, Trickbot:21821, Ursnif:8526 | imbalance_ratio=23.36
2026-02-20 21:08:42,292 - INFO - fusion_common - èåˆæ•°æ®åŠ è½½å®Œæˆï¼Œç±»åˆ«æ•°: 6, æ ·æœ¬æ€»æ•°: 44977
2026-02-20 21:08:42,292 - INFO - fusion_common - åŠ è½½èåˆæ•°æ® - å›¾åƒç›®å½•: C:\Repositories\Traffic\FusionModel\dataset\mfcp\image_data\Test, Pcapç›®å½•: C:\Repositories\Traffic\FusionModel\dataset\mfcp\pcap_data\Test
2026-02-20 21:08:42,377 - INFO - fusion_common - èåˆç´¢å¼•ç¼“å­˜å‘½ä¸­: C:\Repositories\Traffic\FusionModel\dataset\mfcp\image_data\Test\.fusion_index_cache_v2_crepositoriestrafficfusionmo_crepositoriestrafficfusionmo.json, æ ·æœ¬æ•°: 12513
2026-02-20 21:08:42,377 - INFO - fusion_common - ç±»åˆ«åˆ†å¸ƒ(Test) - Artemis:2059, Cobalt:262, Dridex:1040, PUA:1649, Trickbot:5428, Ursnif:2075 | imbalance_ratio=20.72
2026-02-20 21:08:42,377 - INFO - fusion_common - èåˆæ•°æ®åŠ è½½å®Œæˆï¼Œç±»åˆ«æ•°: 6, æ ·æœ¬æ€»æ•°: 12513
2026-02-20 21:08:42,377 - INFO - fusion_common - åˆå§‹åŒ–èåˆæ¨¡å‹ï¼Œèåˆæ¨¡å¼: attention
2026-02-20 21:08:42,439 - INFO - fusion_common - CharBERT åŠ è½½æˆåŠŸ: C:\Repositories\Traffic\FusionModel\src\CharBERT\src
2026-02-20 21:08:42,441 - INFO - fusion_common - èåˆæ¨¡å‹åˆå§‹åŒ–å®Œæˆï¼Œåˆ†ç±»å¤´è®¾ç½®ä¸º 6 ä¸ªç±»åˆ«
2026-02-20 21:08:42,442 - INFO - fusion_common - å¼€å§‹è®­ç»ƒèåˆæ¨¡å‹
2026-02-20 21:08:42,442 - INFO - fusion_common - è®­ç»ƒå‚æ•° - Epochs: 24, Learning Rate: 0.001, Early Stopping Patience: 8
2026-02-20 21:08:42,442 - INFO - fusion_common - è®­ç»ƒç­–ç•¥ - class_balance: none, loss_type: ce, focal_gamma: 2.000, weight_decay: 0.000000, label_smoothing: 0.0000, early_stop_metric: val_loss, lr_scheduler: none, val_every: 1
2026-02-20 21:08:42,442 - INFO - fusion_common - DataLoaderå‚æ•° - train_batches: 703, val_batches: 196, batch_size: 64, num_workers: 0, pin_memory: True
2026-02-20 21:08:42,618 - INFO - fusion_common - ğŸ§­ Epoch 1/24
2026-02-20 21:11:17,866 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=1
2026-02-20 21:11:29,864 - INFO - fusion_common - ğŸ“Š Epoch 1 ç»“æœ: è®­ç»ƒ Loss: 0.2287, è®­ç»ƒ Acc: 0.9005, è®­ç»ƒ F1: 0.7133 | éªŒè¯ Loss: 0.3408, éªŒè¯ Acc: 0.9079, éªŒè¯ F1: 0.7645
2026-02-20 21:11:29,884 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 0/8
2026-02-20 21:11:29,884 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-20 21:11:29,885 - INFO - fusion_common - ğŸ§­ Epoch 2/24
2026-02-20 21:12:49,583 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=2
2026-02-20 21:13:00,100 - INFO - fusion_common - ğŸ“Š Epoch 2 ç»“æœ: è®­ç»ƒ Loss: 0.1338, è®­ç»ƒ Acc: 0.9435, è®­ç»ƒ F1: 0.8130 | éªŒè¯ Loss: 0.2462, éªŒè¯ Acc: 0.9166, éªŒè¯ F1: 0.8285
2026-02-20 21:13:00,120 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 0/8
2026-02-20 21:13:00,120 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-20 21:13:00,120 - INFO - fusion_common - ğŸ§­ Epoch 3/24
2026-02-20 21:14:19,178 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=3
2026-02-20 21:14:29,984 - INFO - fusion_common - ğŸ“Š Epoch 3 ç»“æœ: è®­ç»ƒ Loss: 0.1480, è®­ç»ƒ Acc: 0.9407, è®­ç»ƒ F1: 0.8001 | éªŒè¯ Loss: 0.2600, éªŒè¯ Acc: 0.9113, éªŒè¯ F1: 0.7744
2026-02-20 21:14:29,985 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 1/8
2026-02-20 21:14:29,985 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-20 21:14:29,985 - INFO - fusion_common - ğŸ§­ Epoch 4/24
2026-02-20 21:15:49,430 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=4
2026-02-20 21:15:59,778 - INFO - fusion_common - ğŸ“Š Epoch 4 ç»“æœ: è®­ç»ƒ Loss: 0.1363, è®­ç»ƒ Acc: 0.9437, è®­ç»ƒ F1: 0.8196 | éªŒè¯ Loss: 0.2089, éªŒè¯ Acc: 0.9164, éªŒè¯ F1: 0.8390
2026-02-20 21:15:59,799 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 0/8
2026-02-20 21:15:59,800 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-20 21:15:59,800 - INFO - fusion_common - ğŸ§­ Epoch 5/24
2026-02-20 21:17:18,971 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=5
2026-02-20 21:17:29,743 - INFO - fusion_common - ğŸ“Š Epoch 5 ç»“æœ: è®­ç»ƒ Loss: 0.1275, è®­ç»ƒ Acc: 0.9462, è®­ç»ƒ F1: 0.8303 | éªŒè¯ Loss: 0.2036, éªŒè¯ Acc: 0.9174, éªŒè¯ F1: 0.8418
2026-02-20 21:17:29,765 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 0/8
2026-02-20 21:17:29,765 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-20 21:17:29,765 - INFO - fusion_common - ğŸ§­ Epoch 6/24
2026-02-20 21:18:48,729 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=6
2026-02-20 21:18:59,506 - INFO - fusion_common - ğŸ“Š Epoch 6 ç»“æœ: è®­ç»ƒ Loss: 0.2322, è®­ç»ƒ Acc: 0.9019, è®­ç»ƒ F1: 0.7313 | éªŒè¯ Loss: 0.2452, éªŒè¯ Acc: 0.9333, éªŒè¯ F1: 0.7679
2026-02-20 21:18:59,506 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 1/8
2026-02-20 21:18:59,506 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-20 21:18:59,507 - INFO - fusion_common - ğŸ§­ Epoch 7/24
2026-02-20 21:20:18,875 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=7
2026-02-20 21:20:29,826 - INFO - fusion_common - ğŸ“Š Epoch 7 ç»“æœ: è®­ç»ƒ Loss: 0.1635, è®­ç»ƒ Acc: 0.9307, è®­ç»ƒ F1: 0.7352 | éªŒè¯ Loss: 0.2325, éªŒè¯ Acc: 0.9332, éªŒè¯ F1: 0.7739
2026-02-20 21:20:29,826 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 2/8
2026-02-20 21:20:29,826 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-20 21:20:29,826 - INFO - fusion_common - ğŸ§­ Epoch 8/24
2026-02-20 21:21:49,651 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=8
2026-02-20 21:22:00,056 - INFO - fusion_common - ğŸ“Š Epoch 8 ç»“æœ: è®­ç»ƒ Loss: 0.1621, è®­ç»ƒ Acc: 0.9317, è®­ç»ƒ F1: 0.7485 | éªŒè¯ Loss: 0.5708, éªŒè¯ Acc: 0.7113, éªŒè¯ F1: 0.6916
2026-02-20 21:22:00,057 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 3/8
2026-02-20 21:22:00,057 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-20 21:22:00,057 - INFO - fusion_common - ğŸ§­ Epoch 9/24
2026-02-20 21:23:19,962 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=9
2026-02-20 21:23:30,813 - INFO - fusion_common - ğŸ“Š Epoch 9 ç»“æœ: è®­ç»ƒ Loss: 0.1537, è®­ç»ƒ Acc: 0.9328, è®­ç»ƒ F1: 0.7586 | éªŒè¯ Loss: 0.4022, éªŒè¯ Acc: 0.8217, éªŒè¯ F1: 0.7443
2026-02-20 21:23:30,813 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 4/8
2026-02-20 21:23:30,814 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-20 21:23:30,814 - INFO - fusion_common - ğŸ§­ Epoch 10/24
2026-02-20 21:24:50,301 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=10
2026-02-20 21:25:00,842 - INFO - fusion_common - ğŸ“Š Epoch 10 ç»“æœ: è®­ç»ƒ Loss: 0.1508, è®­ç»ƒ Acc: 0.9394, è®­ç»ƒ F1: 0.7933 | éªŒè¯ Loss: 0.3364, éªŒè¯ Acc: 0.8658, éªŒè¯ F1: 0.7459
2026-02-20 21:25:00,842 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 5/8
2026-02-20 21:25:00,843 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-20 21:25:00,843 - INFO - fusion_common - ğŸ§­ Epoch 11/24
2026-02-20 21:26:19,867 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=11
2026-02-20 21:26:30,749 - INFO - fusion_common - ğŸ“Š Epoch 11 ç»“æœ: è®­ç»ƒ Loss: 0.1485, è®­ç»ƒ Acc: 0.9362, è®­ç»ƒ F1: 0.7712 | éªŒè¯ Loss: 0.3359, éªŒè¯ Acc: 0.8851, éªŒè¯ F1: 0.8140
2026-02-20 21:26:30,750 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 6/8
2026-02-20 21:26:30,750 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-20 21:26:30,750 - INFO - fusion_common - ğŸ§­ Epoch 12/24
2026-02-20 21:27:50,574 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=12
2026-02-20 21:28:01,395 - INFO - fusion_common - ğŸ“Š Epoch 12 ç»“æœ: è®­ç»ƒ Loss: 0.1548, è®­ç»ƒ Acc: 0.9396, è®­ç»ƒ F1: 0.7943 | éªŒè¯ Loss: 0.3927, éªŒè¯ Acc: 0.8568, éªŒè¯ F1: 0.7631
2026-02-20 21:28:01,396 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 7/8
2026-02-20 21:28:01,396 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-20 21:28:01,396 - INFO - fusion_common - ğŸ§­ Epoch 13/24
2026-02-20 21:29:21,245 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=13
2026-02-20 21:29:32,214 - INFO - fusion_common - ğŸ“Š Epoch 13 ç»“æœ: è®­ç»ƒ Loss: 0.1405, è®­ç»ƒ Acc: 0.9399, è®­ç»ƒ F1: 0.7928 | éªŒè¯ Loss: 0.4115, éªŒè¯ Acc: 0.8258, éªŒè¯ F1: 0.7931
2026-02-20 21:29:32,223 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 8/8
2026-02-20 21:29:32,224 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-20 21:29:32,224 - INFO - fusion_common - ğŸ›‘ æ—©åœè§¦å‘ï¼Œåœ¨ç¬¬ 13 è½®ååœæ­¢è®­ç»ƒ
2026-02-20 21:29:32,234 - INFO - fusion_common - âœ… å·²æ¢å¤æœ€ä½³éªŒè¯æƒé‡: metric=val_loss, best_score=0.203604, mode=min
2026-02-20 21:29:32,234 - INFO - fusion_common - èåˆæ¨¡å‹è®­ç»ƒå®Œæˆ
2026-02-20 21:29:34,831 - INFO - run_mfcp_attention_stacking - [AttentionDiag] mean=0.001276 min=0.000638 max=0.001509 entropy=6.6644 top1=0.0013 top5=0.0067 top10=0.0131 nonpad_mass=1.0000 pad_mass=0.0000 nonpad_frac=1.0000
2026-02-20 21:29:35,216 - INFO - run_mfcp_attention_stacking - [AttentionDiag] saved attention curve: C:\Repositories\Traffic\FusionModel\outputs\attention_curve_mfcp_attention_stacking_20260220_210842.png
2026-02-20 21:29:35,409 - INFO - run_mfcp_attention_stacking - âœ… å·²ä¿å­˜ metrics_curve_mfcp_attention_stacking: C:\Repositories\Traffic\FusionModel\outputs\metrics_curve_mfcp_attention_stacking_20260220_210842.png (exists=True)
2026-02-20 21:31:08,238 - INFO - run_mfcp_attention_stacking - ğŸ“Š [mfcp_attention_stacking_xgboost] acc=0.9205 macro_f1=0.8343
2026-02-20 21:31:08,238 - INFO - run_mfcp_attention_stacking - [mfcp_attention_stacking_xgboost] åˆ†ç±»æŠ¥å‘Š:
              precision    recall  f1-score   support

           0     0.9961    0.9981    0.9971      2059
           1     0.7083    0.4542    0.5535       262
           2     0.6089    0.8952    0.7248      1040
           3     0.8955    0.6756    0.7701      1649
           4     0.9621    0.9637    0.9629      5428
           5     0.9981    0.9966    0.9973      2075

    accuracy                         0.9205     12513
   macro avg     0.8615    0.8306    0.8343     12513
weighted avg     0.9302    0.9205    0.9205     12513

2026-02-20 21:31:08,238 - INFO - run_mfcp_attention_stacking - [mfcp_attention_stacking_xgboost] æ··æ·†çŸ©é˜µ:
[[2055    0    1    0    0    3]
 [   1  119   55   65   22    0]
 [   1    9  931   34   65    0]
 [   0   29  386 1114  119    1]
 [   1   11  155   30 5231    0]
 [   5    0    1    1    0 2068]]
2026-02-20 21:31:08,428 - INFO - run_mfcp_attention_stacking - âœ… å·²ä¿å­˜ confusion_matrix_mfcp_attention_stacking_xgboost: C:\Repositories\Traffic\FusionModel\outputs\confusion_matrix_mfcp_attention_stacking_xgboost_20260220_210842.png (exists=True)
2026-02-20 21:31:08,428 - INFO - run_mfcp_attention_stacking - âœ… å·²ä¿å­˜ report_mfcp_attention_stacking_xgboost: C:\Repositories\Traffic\FusionModel\outputs\report_mfcp_attention_stacking_xgboost_20260220_210842.md (exists=True)
2026-02-20 21:31:08,445 - INFO - run_mfcp_attention_stacking - âœ… å·²ä¿å­˜ meta_model_mfcp_attention_stacking_xgboost: C:\Repositories\Traffic\FusionModel\outputs\meta_model_mfcp_attention_stacking_xgboost.pkl (exists=True)
2026-02-20 21:31:08,619 - INFO - run_mfcp_attention_stacking - âœ… å·²ä¿å­˜ model_mfcp_attention_stacking_base: C:\Repositories\Traffic\FusionModel\outputs\fusion_model_mfcp_attention_stacking_base.pth (exists=True)
2026-02-20 21:31:08,641 - INFO - run_mfcp_attention_stacking - ğŸ—‚ï¸ å·²å½’æ¡£æ–‡ä»¶æ•°: 7, ç›®å½•: C:\Repositories\Traffic\FusionModel\outputs\archive\20260220_213108_mfcp_mfcp_attention_stacking
2026-02-20 21:31:08,641 - INFO - run_mfcp_attention_stacking - ğŸ—‚ï¸ æœ¬æ¬¡è®­ç»ƒå½’æ¡£ç›®å½•: C:\Repositories\Traffic\FusionModel\outputs\archive\20260220_213108_mfcp_mfcp_attention_stacking
2026-02-20 21:31:08,641 - INFO - run_mfcp_attention_stacking - ğŸ stacking å®Œæˆ, log=C:\Repositories\Traffic\FusionModel\outputs\logs\mfcp_attention_stacking_20260220_210842.log
