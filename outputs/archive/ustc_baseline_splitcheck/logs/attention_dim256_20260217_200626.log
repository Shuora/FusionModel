2026-02-17 20:06:26,816 - INFO - run_attention - ğŸš€ å¼€å§‹è®­ç»ƒæ¨¡å¼=attention, outputs=C:\Repositories\Traffic\FusionModel\outputs
2026-02-17 20:06:26,816 - INFO - fusion_common - åŠ è½½èåˆæ•°æ® - å›¾åƒç›®å½•: dataset\USTC-TFC2016\image_data\Train, Pcapç›®å½•: dataset\USTC-TFC2016\pcap_data\Train
2026-02-17 20:06:26,963 - INFO - fusion_common - èåˆç´¢å¼•ç¼“å­˜å‘½ä¸­: dataset\USTC-TFC2016\image_data\Train\.fusion_index_cache_v1_crepositoriestrafficfusionmo_crepositoriestrafficfusionmo.json, æ ·æœ¬æ•°: 52338
2026-02-17 20:06:26,965 - INFO - fusion_common - ç±»åˆ«åˆ†å¸ƒ(Train) - Cridex:6548, Geodo:5296, Htbot:4794, Miuref:899, Neris:6275, Nsis-ay:4817, Shifu:7607, Tinba:6846, Virut:4712, Zeus:4544 | imbalance_ratio=8.46
2026-02-17 20:06:26,967 - INFO - fusion_common - èåˆæ•°æ®åŠ è½½å®Œæˆï¼Œç±»åˆ«æ•°: 10, æ ·æœ¬æ€»æ•°: 52338
2026-02-17 20:06:26,967 - INFO - fusion_common - åŠ è½½èåˆæ•°æ® - å›¾åƒç›®å½•: dataset\USTC-TFC2016\image_data\Test, Pcapç›®å½•: dataset\USTC-TFC2016\pcap_data\Test
2026-02-17 20:06:26,988 - INFO - fusion_common - èåˆç´¢å¼•ç¼“å­˜å‘½ä¸­: dataset\USTC-TFC2016\image_data\Test\.fusion_index_cache_v1_crepositoriestrafficfusionmo_crepositoriestrafficfusionmo.json, æ ·æœ¬æ•°: 12982
2026-02-17 20:06:26,988 - INFO - fusion_common - ç±»åˆ«åˆ†å¸ƒ(Test) - Cridex:1648, Geodo:1393, Htbot:1130, Miuref:209, Neris:1511, Nsis-ay:1194, Shifu:1968, Tinba:1657, Virut:1165, Zeus:1107 | imbalance_ratio=9.42
2026-02-17 20:06:26,988 - INFO - fusion_common - èåˆæ•°æ®åŠ è½½å®Œæˆï¼Œç±»åˆ«æ•°: 10, æ ·æœ¬æ€»æ•°: 12982
2026-02-17 20:06:26,988 - INFO - fusion_common - åˆå§‹åŒ–èåˆæ¨¡å‹ï¼Œèåˆæ¨¡å¼: attention
2026-02-17 20:06:27,070 - INFO - fusion_common - CharBERT åŠ è½½æˆåŠŸ: C:\Repositories\Traffic\FusionModel\src\CharBERT\src
2026-02-17 20:06:27,073 - INFO - fusion_common - èåˆæ¨¡å‹åˆå§‹åŒ–å®Œæˆï¼Œåˆ†ç±»å¤´è®¾ç½®ä¸º 10 ä¸ªç±»åˆ«
2026-02-17 20:06:27,073 - INFO - fusion_common - å¼€å§‹è®­ç»ƒèåˆæ¨¡å‹
2026-02-17 20:06:27,073 - INFO - fusion_common - è®­ç»ƒå‚æ•° - Epochs: 32, Learning Rate: 0.001, Early Stopping Patience: 8
2026-02-17 20:06:27,074 - INFO - fusion_common - è®­ç»ƒç­–ç•¥ - class_balance: none, loss_type: ce, focal_gamma: 2.000, weight_decay: 0.000000, label_smoothing: 0.0000, early_stop_metric: val_loss, lr_scheduler: none, val_every: 1
2026-02-17 20:06:27,074 - INFO - fusion_common - DataLoaderå‚æ•° - train_batches: 818, val_batches: 203, batch_size: 64, num_workers: 4, pin_memory: True
2026-02-17 20:06:27,423 - INFO - fusion_common - ğŸ§­ Epoch 1/32
2026-02-17 20:09:20,339 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=1
2026-02-17 20:09:45,472 - INFO - fusion_common - ğŸ“Š Epoch 1 ç»“æœ: è®­ç»ƒ Loss: 0.3610, è®­ç»ƒ Acc: 0.8692, è®­ç»ƒ F1: 0.8617 | éªŒè¯ Loss: 0.1255, éªŒè¯ Acc: 0.9582, éªŒè¯ F1: 0.9548
2026-02-17 20:09:45,492 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 0/8
2026-02-17 20:09:45,492 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-17 20:09:45,492 - INFO - fusion_common - ğŸ§­ Epoch 2/32
2026-02-17 20:10:56,181 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=2
2026-02-17 20:11:01,918 - INFO - fusion_common - ğŸ“Š Epoch 2 ç»“æœ: è®­ç»ƒ Loss: 0.1363, è®­ç»ƒ Acc: 0.9522, è®­ç»ƒ F1: 0.9500 | éªŒè¯ Loss: 0.1552, éªŒè¯ Acc: 0.9575, éªŒè¯ F1: 0.9549
2026-02-17 20:11:01,918 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 1/8
2026-02-17 20:11:01,918 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-17 20:11:01,918 - INFO - fusion_common - ğŸ§­ Epoch 3/32
2026-02-17 20:12:12,884 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=3
2026-02-17 20:12:18,333 - INFO - fusion_common - ğŸ“Š Epoch 3 ç»“æœ: è®­ç»ƒ Loss: 0.1073, è®­ç»ƒ Acc: 0.9611, è®­ç»ƒ F1: 0.9592 | éªŒè¯ Loss: 0.0830, éªŒè¯ Acc: 0.9723, éªŒè¯ F1: 0.9706
2026-02-17 20:12:18,352 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 0/8
2026-02-17 20:12:18,352 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-17 20:12:18,352 - INFO - fusion_common - ğŸ§­ Epoch 4/32
2026-02-17 20:13:29,491 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=4
2026-02-17 20:13:35,024 - INFO - fusion_common - ğŸ“Š Epoch 4 ç»“æœ: è®­ç»ƒ Loss: 0.0946, è®­ç»ƒ Acc: 0.9660, è®­ç»ƒ F1: 0.9638 | éªŒè¯ Loss: 0.0875, éªŒè¯ Acc: 0.9749, éªŒè¯ F1: 0.9736
2026-02-17 20:13:35,024 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 1/8
2026-02-17 20:13:35,024 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-17 20:13:35,024 - INFO - fusion_common - ğŸ§­ Epoch 5/32
2026-02-17 20:14:45,524 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=5
2026-02-17 20:14:50,933 - INFO - fusion_common - ğŸ“Š Epoch 5 ç»“æœ: è®­ç»ƒ Loss: 0.0864, è®­ç»ƒ Acc: 0.9681, è®­ç»ƒ F1: 0.9665 | éªŒè¯ Loss: 3.7738, éªŒè¯ Acc: 0.8908, éªŒè¯ F1: 0.8855
2026-02-17 20:14:50,933 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 2/8
2026-02-17 20:14:50,933 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-17 20:14:50,933 - INFO - fusion_common - ğŸ§­ Epoch 6/32
2026-02-17 20:16:01,991 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=6
2026-02-17 20:16:07,776 - INFO - fusion_common - ğŸ“Š Epoch 6 ç»“æœ: è®­ç»ƒ Loss: 0.0861, è®­ç»ƒ Acc: 0.9700, è®­ç»ƒ F1: 0.9685 | éªŒè¯ Loss: 0.0718, éªŒè¯ Acc: 0.9758, éªŒè¯ F1: 0.9745
2026-02-17 20:16:07,802 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 0/8
2026-02-17 20:16:07,802 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-17 20:16:07,802 - INFO - fusion_common - ğŸ§­ Epoch 7/32
2026-02-17 20:17:19,283 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=7
2026-02-17 20:17:24,904 - INFO - fusion_common - ğŸ“Š Epoch 7 ç»“æœ: è®­ç»ƒ Loss: 0.0800, è®­ç»ƒ Acc: 0.9713, è®­ç»ƒ F1: 0.9697 | éªŒè¯ Loss: 0.0976, éªŒè¯ Acc: 0.9740, éªŒè¯ F1: 0.9735
2026-02-17 20:17:24,905 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 1/8
2026-02-17 20:17:24,905 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-17 20:17:24,905 - INFO - fusion_common - ğŸ§­ Epoch 8/32
2026-02-17 20:18:36,178 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=8
2026-02-17 20:18:41,593 - INFO - fusion_common - ğŸ“Š Epoch 8 ç»“æœ: è®­ç»ƒ Loss: 0.0693, è®­ç»ƒ Acc: 0.9748, è®­ç»ƒ F1: 0.9732 | éªŒè¯ Loss: 0.0814, éªŒè¯ Acc: 0.9787, éªŒè¯ F1: 0.9781
2026-02-17 20:18:41,593 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 2/8
2026-02-17 20:18:41,593 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-17 20:18:41,594 - INFO - fusion_common - ğŸ§­ Epoch 9/32
2026-02-17 20:19:52,773 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=9
2026-02-17 20:19:58,565 - INFO - fusion_common - ğŸ“Š Epoch 9 ç»“æœ: è®­ç»ƒ Loss: 0.0701, è®­ç»ƒ Acc: 0.9747, è®­ç»ƒ F1: 0.9733 | éªŒè¯ Loss: 0.0630, éªŒè¯ Acc: 0.9772, éªŒè¯ F1: 0.9763
2026-02-17 20:19:58,591 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 0/8
2026-02-17 20:19:58,592 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-17 20:19:58,592 - INFO - fusion_common - ğŸ§­ Epoch 10/32
2026-02-17 20:21:10,287 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=10
2026-02-17 20:21:15,914 - INFO - fusion_common - ğŸ“Š Epoch 10 ç»“æœ: è®­ç»ƒ Loss: 0.0688, è®­ç»ƒ Acc: 0.9752, è®­ç»ƒ F1: 0.9741 | éªŒè¯ Loss: 0.0865, éªŒè¯ Acc: 0.9767, éªŒè¯ F1: 0.9750
2026-02-17 20:21:15,914 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 1/8
2026-02-17 20:21:15,914 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-17 20:21:15,914 - INFO - fusion_common - ğŸ§­ Epoch 11/32
2026-02-17 20:22:27,200 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=11
2026-02-17 20:22:32,811 - INFO - fusion_common - ğŸ“Š Epoch 11 ç»“æœ: è®­ç»ƒ Loss: 0.0736, è®­ç»ƒ Acc: 0.9742, è®­ç»ƒ F1: 0.9716 | éªŒè¯ Loss: 0.1096, éªŒè¯ Acc: 0.9763, éªŒè¯ F1: 0.9749
2026-02-17 20:22:32,811 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 2/8
2026-02-17 20:22:32,812 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-17 20:22:32,812 - INFO - fusion_common - ğŸ§­ Epoch 12/32
2026-02-17 20:23:43,865 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=12
2026-02-17 20:23:49,587 - INFO - fusion_common - ğŸ“Š Epoch 12 ç»“æœ: è®­ç»ƒ Loss: 0.0594, è®­ç»ƒ Acc: 0.9777, è®­ç»ƒ F1: 0.9766 | éªŒè¯ Loss: 0.0736, éªŒè¯ Acc: 0.9779, éªŒè¯ F1: 0.9772
2026-02-17 20:23:49,587 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 3/8
2026-02-17 20:23:49,587 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-17 20:23:49,587 - INFO - fusion_common - ğŸ§­ Epoch 13/32
2026-02-17 20:25:00,855 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=13
2026-02-17 20:25:06,276 - INFO - fusion_common - ğŸ“Š Epoch 13 ç»“æœ: è®­ç»ƒ Loss: 0.0608, è®­ç»ƒ Acc: 0.9779, è®­ç»ƒ F1: 0.9769 | éªŒè¯ Loss: 0.0687, éªŒè¯ Acc: 0.9804, éªŒè¯ F1: 0.9792
2026-02-17 20:25:06,276 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 4/8
2026-02-17 20:25:06,276 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-17 20:25:06,276 - INFO - fusion_common - ğŸ§­ Epoch 14/32
2026-02-17 20:26:17,387 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=14
2026-02-17 20:26:22,793 - INFO - fusion_common - ğŸ“Š Epoch 14 ç»“æœ: è®­ç»ƒ Loss: 0.0586, è®­ç»ƒ Acc: 0.9786, è®­ç»ƒ F1: 0.9771 | éªŒè¯ Loss: 0.1108, éªŒè¯ Acc: 0.9707, éªŒè¯ F1: 0.9703
2026-02-17 20:26:22,793 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 5/8
2026-02-17 20:26:22,793 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-17 20:26:22,793 - INFO - fusion_common - ğŸ§­ Epoch 15/32
2026-02-17 20:27:33,863 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=15
2026-02-17 20:27:39,416 - INFO - fusion_common - ğŸ“Š Epoch 15 ç»“æœ: è®­ç»ƒ Loss: 0.0556, è®­ç»ƒ Acc: 0.9797, è®­ç»ƒ F1: 0.9788 | éªŒè¯ Loss: 0.0724, éªŒè¯ Acc: 0.9809, éªŒè¯ F1: 0.9805
2026-02-17 20:27:39,416 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 6/8
2026-02-17 20:27:39,416 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-17 20:27:39,416 - INFO - fusion_common - ğŸ§­ Epoch 16/32
2026-02-17 20:28:50,963 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=16
2026-02-17 20:28:56,598 - INFO - fusion_common - ğŸ“Š Epoch 16 ç»“æœ: è®­ç»ƒ Loss: 0.0576, è®­ç»ƒ Acc: 0.9785, è®­ç»ƒ F1: 0.9766 | éªŒè¯ Loss: 0.0930, éªŒè¯ Acc: 0.9753, éªŒè¯ F1: 0.9745
2026-02-17 20:28:56,599 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 7/8
2026-02-17 20:28:56,599 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-17 20:28:56,599 - INFO - fusion_common - ğŸ§­ Epoch 17/32
2026-02-17 20:30:08,305 - INFO - fusion_common - ğŸ§ª å¼€å§‹éªŒè¯: epoch=17
2026-02-17 20:30:13,840 - INFO - fusion_common - ğŸ“Š Epoch 17 ç»“æœ: è®­ç»ƒ Loss: 0.0585, è®­ç»ƒ Acc: 0.9791, è®­ç»ƒ F1: 0.9780 | éªŒè¯ Loss: 0.0674, éªŒè¯ Acc: 0.9787, éªŒè¯ F1: 0.9779
2026-02-17 20:30:13,851 - INFO - fusion_common - â±ï¸ æ—©åœè®¡æ•°: 8/8
2026-02-17 20:30:13,851 - INFO - fusion_common - ğŸ“‰ å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-17 20:30:13,851 - INFO - fusion_common - ğŸ›‘ æ—©åœè§¦å‘ï¼Œåœ¨ç¬¬ 17 è½®ååœæ­¢è®­ç»ƒ
2026-02-17 20:30:13,861 - INFO - fusion_common - âœ… å·²æ¢å¤æœ€ä½³éªŒè¯æƒé‡: metric=val_loss, best_score=0.063019, mode=min
2026-02-17 20:30:13,861 - INFO - fusion_common - èåˆæ¨¡å‹è®­ç»ƒå®Œæˆ
2026-02-17 20:30:16,302 - INFO - run_attention - [AttentionDiag] mean=0.001276 min=0.000444 max=0.002520 entropy=6.6334 top1=0.0020 top5=0.0093 top10=0.0181 nonpad_mass=1.0000 pad_mass=0.0000 nonpad_frac=1.0000
2026-02-17 20:30:17,376 - INFO - run_attention - [AttentionDiag] saved attention curve: C:\Repositories\Traffic\FusionModel\outputs\attention_curve_attention_dim256_20260217_200626.png
2026-02-17 20:30:23,226 - INFO - run_attention - ğŸ“Š è¯„ä¼°ç»“æœ:
2026-02-17 20:30:23,226 - INFO - run_attention -   - å‡†ç¡®ç‡(ACC): 0.9772
2026-02-17 20:30:23,227 - INFO - run_attention -   - Macro F1: 0.9763
2026-02-17 20:30:23,227 - INFO - run_attention -   åˆ†ç±»æŠ¥å‘Š:
              precision    recall  f1-score   support

           0     1.0000    0.9994    0.9997      1648
           1     0.9914    0.9914    0.9914      1393
           2     0.9937    0.9823    0.9880      1130
           3     0.9765    0.9952    0.9858       209
           4     0.9783    0.8657    0.9185      1511
           5     0.9824    0.9799    0.9811      1194
           6     0.9995    0.9975    0.9985      1968
           7     0.9946    0.9988    0.9967      1657
           8     0.8495    0.9785    0.9095      1165
           9     0.9910    0.9973    0.9941      1107

    accuracy                         0.9772     12982
   macro avg     0.9757    0.9786    0.9763     12982
weighted avg     0.9790    0.9772    0.9773     12982

2026-02-17 20:30:23,227 - INFO - run_attention -   æ··æ·†çŸ©é˜µ:
[[1647    0    0    0    0    0    0    1    0    0]
 [   0 1381    3    1    0    0    0    7    0    1]
 [   0    9 1110    1    5    0    0    0    3    2]
 [   0    0    0  208    1    0    0    0    0    0]
 [   0    2    1    1 1308   13    1    0  184    1]
 [   0    1    1    1   10 1170    0    0   11    0]
 [   0    0    2    1    0    0 1963    1    1    0]
 [   0    0    0    0    0    0    0 1655    0    2]
 [   0    0    0    0   13    8    0    0 1140    4]
 [   0    0    0    0    0    0    0    0    3 1104]]
2026-02-17 20:30:23,440 - INFO - run_attention - âœ… å·²ä¿å­˜ metrics_curve_attention_dim256: C:\Repositories\Traffic\FusionModel\outputs\metrics_curve_attention_dim256_20260217_200626.png (exists=True)
2026-02-17 20:30:23,613 - INFO - run_attention - âœ… å·²ä¿å­˜ confusion_matrix_attention_dim256: C:\Repositories\Traffic\FusionModel\outputs\confusion_matrix_attention_dim256_20260217_200626.png (exists=True)
2026-02-17 20:30:23,614 - INFO - run_attention - âœ… å·²ä¿å­˜ report_attention_dim256: C:\Repositories\Traffic\FusionModel\outputs\report_attention_dim256_20260217_200626.md (exists=True)
2026-02-17 20:30:23,669 - INFO - run_attention - âœ… å·²ä¿å­˜ model_attention_dim256: C:\Repositories\Traffic\FusionModel\outputs\fusion_model_attention_dim256.pth (exists=True)
2026-02-17 20:30:23,669 - INFO - run_attention - ğŸ è®­ç»ƒå®Œæˆ mode=attention, log=C:\Repositories\Traffic\FusionModel\outputs\logs\attention_dim256_20260217_200626.log
