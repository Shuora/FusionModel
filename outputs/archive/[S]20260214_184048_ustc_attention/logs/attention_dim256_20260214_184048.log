2026-02-14 18:40:48,190 - INFO - run_attention - ğŸš€ å¼€å§‹è®­ç»ƒæ¨¡å¼=attention, outputs=C:\Repositories\Traffic\FusionModel\outputs
2026-02-14 18:40:48,190 - INFO - fusion_common - åŠ è½½èåˆæ•°æ® - å›¾åƒç›®å½•: C:\Repositories\Traffic\FusionModel\dataset\USTC-TFC2016\image_data\Train, Pcapç›®å½•: C:\Repositories\Traffic\FusionModel\dataset\USTC-TFC2016\pcap_data\Train
2026-02-14 18:40:48,331 - INFO - fusion_common - èåˆç´¢å¼•ç¼“å­˜å‘½ä¸­: C:\Repositories\Traffic\FusionModel\dataset\USTC-TFC2016\image_data\Train\.fusion_index_cache_v1_crepositoriestrafficfusionmo_crepositoriestrafficfusionmo.json, æ ·æœ¬æ•°: 52338
2026-02-14 18:40:48,334 - INFO - fusion_common - èåˆæ•°æ®åŠ è½½å®Œæˆï¼Œç±»åˆ«æ•°: 10, æ ·æœ¬æ€»æ•°: 52338
2026-02-14 18:40:48,334 - INFO - fusion_common - åŠ è½½èåˆæ•°æ® - å›¾åƒç›®å½•: C:\Repositories\Traffic\FusionModel\dataset\USTC-TFC2016\image_data\Test, Pcapç›®å½•: C:\Repositories\Traffic\FusionModel\dataset\USTC-TFC2016\pcap_data\Test
2026-02-14 18:40:48,352 - INFO - fusion_common - èåˆç´¢å¼•ç¼“å­˜å‘½ä¸­: C:\Repositories\Traffic\FusionModel\dataset\USTC-TFC2016\image_data\Test\.fusion_index_cache_v1_crepositoriestrafficfusionmo_crepositoriestrafficfusionmo.json, æ ·æœ¬æ•°: 12982
2026-02-14 18:40:48,353 - INFO - fusion_common - èåˆæ•°æ®åŠ è½½å®Œæˆï¼Œç±»åˆ«æ•°: 10, æ ·æœ¬æ€»æ•°: 12982
2026-02-14 18:40:48,353 - INFO - fusion_common - åˆå§‹åŒ–èåˆæ¨¡å‹ï¼Œèåˆæ¨¡å¼: attention
2026-02-14 18:40:48,438 - INFO - fusion_common - CharBERT åŠ è½½æˆåŠŸ: C:\Repositories\Traffic\FusionModel\src\CharBERT\src
2026-02-14 18:40:48,441 - INFO - fusion_common - èåˆæ¨¡å‹åˆå§‹åŒ–å®Œæˆï¼Œåˆ†ç±»å¤´è®¾ç½®ä¸º 10 ä¸ªç±»åˆ«
2026-02-14 18:40:48,442 - INFO - fusion_common - å¼€å§‹è®­ç»ƒèåˆæ¨¡å‹
2026-02-14 18:40:48,442 - INFO - fusion_common - è®­ç»ƒå‚æ•° - Epochs: 32, Learning Rate: 0.001, Early Stopping Patience: 8
2026-02-14 18:40:48,442 - INFO - fusion_common - è®­ç»ƒç­–ç•¥ - class_balance: none, loss_type: ce, focal_gamma: 2.000, weight_decay: 0.000000, label_smoothing: 0.0000, early_stop_metric: val_loss, lr_scheduler: none, val_every: 1
2026-02-14 18:40:48,442 - INFO - fusion_common - DataLoaderå‚æ•° - train_batches: 818, val_batches: 203, batch_size: 64, num_workers: 4, pin_memory: True
2026-02-14 18:40:48,563 - INFO - fusion_common - Epoch 1/32
2026-02-14 18:44:40,379 - INFO - fusion_common - Epoch 1 ç»“æœ: è®­ç»ƒ Loss: 0.3629, è®­ç»ƒ Acc: 0.8649, è®­ç»ƒ F1: 0.8564 | éªŒè¯ Loss: 0.1376, éªŒè¯ Acc: 0.9559, éªŒè¯ F1: 0.9529
2026-02-14 18:44:40,398 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 0/8
2026-02-14 18:44:40,399 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-14 18:44:40,399 - INFO - fusion_common - Epoch 2/32
2026-02-14 18:45:58,774 - INFO - fusion_common - Epoch 2 ç»“æœ: è®­ç»ƒ Loss: 0.1384, è®­ç»ƒ Acc: 0.9516, è®­ç»ƒ F1: 0.9489 | éªŒè¯ Loss: 0.1238, éªŒè¯ Acc: 0.9609, éªŒè¯ F1: 0.9604
2026-02-14 18:45:58,794 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 0/8
2026-02-14 18:45:58,794 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-14 18:45:58,795 - INFO - fusion_common - Epoch 3/32
2026-02-14 18:47:16,490 - INFO - fusion_common - Epoch 3 ç»“æœ: è®­ç»ƒ Loss: 0.1110, è®­ç»ƒ Acc: 0.9598, è®­ç»ƒ F1: 0.9579 | éªŒè¯ Loss: 0.1113, éªŒè¯ Acc: 0.9596, éªŒè¯ F1: 0.9586
2026-02-14 18:47:16,507 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 0/8
2026-02-14 18:47:16,507 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-14 18:47:16,507 - INFO - fusion_common - Epoch 4/32
2026-02-14 18:48:33,398 - INFO - fusion_common - Epoch 4 ç»“æœ: è®­ç»ƒ Loss: 0.1033, è®­ç»ƒ Acc: 0.9630, è®­ç»ƒ F1: 0.9617 | éªŒè¯ Loss: 0.0850, éªŒè¯ Acc: 0.9700, éªŒè¯ F1: 0.9680
2026-02-14 18:48:33,416 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 0/8
2026-02-14 18:48:33,417 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-14 18:48:33,417 - INFO - fusion_common - Epoch 5/32
2026-02-14 18:49:50,922 - INFO - fusion_common - Epoch 5 ç»“æœ: è®­ç»ƒ Loss: 0.0894, è®­ç»ƒ Acc: 0.9671, è®­ç»ƒ F1: 0.9654 | éªŒè¯ Loss: 0.0904, éªŒè¯ Acc: 0.9680, éªŒè¯ F1: 0.9668
2026-02-14 18:49:50,923 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 1/8
2026-02-14 18:49:50,923 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-14 18:49:50,923 - INFO - fusion_common - Epoch 6/32
2026-02-14 18:51:09,246 - INFO - fusion_common - Epoch 6 ç»“æœ: è®­ç»ƒ Loss: 0.0932, è®­ç»ƒ Acc: 0.9657, è®­ç»ƒ F1: 0.9637 | éªŒè¯ Loss: 0.2884, éªŒè¯ Acc: 0.9301, éªŒè¯ F1: 0.9212
2026-02-14 18:51:09,247 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 2/8
2026-02-14 18:51:09,247 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-14 18:51:09,247 - INFO - fusion_common - Epoch 7/32
2026-02-14 18:52:25,906 - INFO - fusion_common - Epoch 7 ç»“æœ: è®­ç»ƒ Loss: 0.0872, è®­ç»ƒ Acc: 0.9679, è®­ç»ƒ F1: 0.9669 | éªŒè¯ Loss: 0.0959, éªŒè¯ Acc: 0.9698, éªŒè¯ F1: 0.9685
2026-02-14 18:52:25,907 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 3/8
2026-02-14 18:52:25,907 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-14 18:52:25,907 - INFO - fusion_common - Epoch 8/32
2026-02-14 18:53:44,102 - INFO - fusion_common - Epoch 8 ç»“æœ: è®­ç»ƒ Loss: 0.0788, è®­ç»ƒ Acc: 0.9710, è®­ç»ƒ F1: 0.9699 | éªŒè¯ Loss: 0.0976, éªŒè¯ Acc: 0.9727, éªŒè¯ F1: 0.9696
2026-02-14 18:53:44,102 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 4/8
2026-02-14 18:53:44,103 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-14 18:53:44,103 - INFO - fusion_common - Epoch 9/32
2026-02-14 18:55:01,907 - INFO - fusion_common - Epoch 9 ç»“æœ: è®­ç»ƒ Loss: 0.0733, è®­ç»ƒ Acc: 0.9725, è®­ç»ƒ F1: 0.9708 | éªŒè¯ Loss: 0.0778, éªŒè¯ Acc: 0.9764, éªŒè¯ F1: 0.9750
2026-02-14 18:55:01,924 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 0/8
2026-02-14 18:55:01,924 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-14 18:55:01,924 - INFO - fusion_common - Epoch 10/32
2026-02-14 18:56:19,023 - INFO - fusion_common - Epoch 10 ç»“æœ: è®­ç»ƒ Loss: 0.0739, è®­ç»ƒ Acc: 0.9724, è®­ç»ƒ F1: 0.9710 | éªŒè¯ Loss: 0.0820, éªŒè¯ Acc: 0.9750, éªŒè¯ F1: 0.9734
2026-02-14 18:56:19,023 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 1/8
2026-02-14 18:56:19,023 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-14 18:56:19,023 - INFO - fusion_common - Epoch 11/32
2026-02-14 18:57:36,735 - INFO - fusion_common - Epoch 11 ç»“æœ: è®­ç»ƒ Loss: 0.0714, è®­ç»ƒ Acc: 0.9736, è®­ç»ƒ F1: 0.9726 | éªŒè¯ Loss: 0.0972, éªŒè¯ Acc: 0.9723, éªŒè¯ F1: 0.9712
2026-02-14 18:57:36,735 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 2/8
2026-02-14 18:57:36,736 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-14 18:57:36,736 - INFO - fusion_common - Epoch 12/32
2026-02-14 18:58:54,159 - INFO - fusion_common - Epoch 12 ç»“æœ: è®­ç»ƒ Loss: 0.0838, è®­ç»ƒ Acc: 0.9703, è®­ç»ƒ F1: 0.9683 | éªŒè¯ Loss: 0.1073, éªŒè¯ Acc: 0.9725, éªŒè¯ F1: 0.9702
2026-02-14 18:58:54,160 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 3/8
2026-02-14 18:58:54,160 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-14 18:58:54,160 - INFO - fusion_common - Epoch 13/32
2026-02-14 19:00:11,303 - INFO - fusion_common - Epoch 13 ç»“æœ: è®­ç»ƒ Loss: 0.0633, è®­ç»ƒ Acc: 0.9760, è®­ç»ƒ F1: 0.9747 | éªŒè¯ Loss: 0.0810, éªŒè¯ Acc: 0.9787, éªŒè¯ F1: 0.9779
2026-02-14 19:00:11,303 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 4/8
2026-02-14 19:00:11,303 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-14 19:00:11,303 - INFO - fusion_common - Epoch 14/32
2026-02-14 19:01:29,026 - INFO - fusion_common - Epoch 14 ç»“æœ: è®­ç»ƒ Loss: 0.0561, è®­ç»ƒ Acc: 0.9781, è®­ç»ƒ F1: 0.9772 | éªŒè¯ Loss: 0.1366, éªŒè¯ Acc: 0.9694, éªŒè¯ F1: 0.9686
2026-02-14 19:01:29,028 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 5/8
2026-02-14 19:01:29,028 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-14 19:01:29,028 - INFO - fusion_common - Epoch 15/32
2026-02-14 19:02:46,553 - INFO - fusion_common - Epoch 15 ç»“æœ: è®­ç»ƒ Loss: 0.0645, è®­ç»ƒ Acc: 0.9761, è®­ç»ƒ F1: 0.9743 | éªŒè¯ Loss: 0.0928, éªŒè¯ Acc: 0.9756, éªŒè¯ F1: 0.9737
2026-02-14 19:02:46,553 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 6/8
2026-02-14 19:02:46,554 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-14 19:02:46,554 - INFO - fusion_common - Epoch 16/32
2026-02-14 19:04:03,613 - INFO - fusion_common - Epoch 16 ç»“æœ: è®­ç»ƒ Loss: 0.0635, è®­ç»ƒ Acc: 0.9767, è®­ç»ƒ F1: 0.9755 | éªŒè¯ Loss: 0.0915, éªŒè¯ Acc: 0.9779, éªŒè¯ F1: 0.9769
2026-02-14 19:04:03,613 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 7/8
2026-02-14 19:04:03,614 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-14 19:04:03,614 - INFO - fusion_common - Epoch 17/32
2026-02-14 19:05:21,657 - INFO - fusion_common - Epoch 17 ç»“æœ: è®­ç»ƒ Loss: 0.0611, è®­ç»ƒ Acc: 0.9773, è®­ç»ƒ F1: 0.9761 | éªŒè¯ Loss: 0.0991, éªŒè¯ Acc: 0.9739, éªŒè¯ F1: 0.9727
2026-02-14 19:05:21,670 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 8/8
2026-02-14 19:05:21,670 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-14 19:05:21,670 - INFO - fusion_common - æ—©åœæœºåˆ¶è§¦å‘ï¼Œåœ¨ç¬¬ 17 è½®ååœæ­¢è®­ç»ƒ
2026-02-14 19:05:21,680 - INFO - fusion_common - âœ… å·²æ¢å¤æœ€ä½³éªŒè¯æƒé‡: metric=val_loss, best_score=0.077763, mode=min
2026-02-14 19:05:21,680 - INFO - fusion_common - èåˆæ¨¡å‹è®­ç»ƒå®Œæˆ
2026-02-14 19:05:24,124 - INFO - run_attention - [AttentionDiag] mean=0.001276 min=0.000015 max=0.027601 entropy=5.1490 top1=0.0174 top5=0.0773 top10=0.1449 nonpad_mass=1.0000 pad_mass=0.0000 nonpad_frac=1.0000
2026-02-14 19:05:24,721 - INFO - run_attention - [AttentionDiag] saved attention curve: C:\Repositories\Traffic\FusionModel\outputs\attention_curve_attention_dim256_20260214_184048.png
2026-02-14 19:05:30,582 - INFO - run_attention - ğŸ“Š è¯„ä¼°ç»“æœ:
2026-02-14 19:05:30,582 - INFO - run_attention -   - å‡†ç¡®ç‡(ACC): 0.9764
2026-02-14 19:05:30,583 - INFO - run_attention -   - Macro F1: 0.9750
2026-02-14 19:05:30,583 - INFO - run_attention -   åˆ†ç±»æŠ¥å‘Š:
              precision    recall  f1-score   support

           0     1.0000    0.9994    0.9997      1648
           1     0.9957    0.9892    0.9924      1393
           2     0.9604    0.9876    0.9738      1130
           3     0.9856    0.9809    0.9832       209
           4     0.9566    0.8901    0.9222      1511
           5     0.9748    0.9724    0.9736      1194
           6     0.9975    0.9975    0.9975      1968
           7     0.9970    0.9994    0.9982      1657
           8     0.8815    0.9451    0.9122      1165
           9     0.9973    0.9964    0.9968      1107

    accuracy                         0.9764     12982
   macro avg     0.9746    0.9758    0.9750     12982
weighted avg     0.9769    0.9764    0.9763     12982

2026-02-14 19:05:30,583 - INFO - run_attention -   æ··æ·†çŸ©é˜µ:
[[1647    0    1    0    0    0    0    0    0    0]
 [   0 1378   12    2    0    0    0    0    1    0]
 [   0    5 1116    0    6    1    0    0    2    0]
 [   0    0    2  205    2    0    0    0    0    0]
 [   0    0   15    0 1345   17    0    1  133    0]
 [   0    0    7    1   11 1161    1    2   10    1]
 [   0    0    2    0    1    0 1963    0    2    0]
 [   0    0    0    0    0    0    0 1656    0    1]
 [   0    1    6    0   41   12    1    2 1101    1]
 [   0    0    1    0    0    0    3    0    0 1103]]
2026-02-14 19:05:30,769 - INFO - run_attention - âœ… å·²ä¿å­˜ metrics_curve_attention_dim256: C:\Repositories\Traffic\FusionModel\outputs\metrics_curve_attention_dim256_20260214_184048.png (exists=True)
2026-02-14 19:05:30,932 - INFO - run_attention - âœ… å·²ä¿å­˜ confusion_matrix_attention_dim256: C:\Repositories\Traffic\FusionModel\outputs\confusion_matrix_attention_dim256_20260214_184048.png (exists=True)
2026-02-14 19:05:30,933 - INFO - run_attention - âœ… å·²ä¿å­˜ report_attention_dim256: C:\Repositories\Traffic\FusionModel\outputs\report_attention_dim256_20260214_184048.md (exists=True)
2026-02-14 19:05:30,989 - INFO - run_attention - âœ… å·²ä¿å­˜ model_attention_dim256: C:\Repositories\Traffic\FusionModel\outputs\fusion_model_attention_dim256.pth (exists=True)
2026-02-14 19:05:30,989 - INFO - run_attention - ğŸ è®­ç»ƒå®Œæˆ mode=attention, log=C:\Repositories\Traffic\FusionModel\outputs\logs\attention_dim256_20260214_184048.log
