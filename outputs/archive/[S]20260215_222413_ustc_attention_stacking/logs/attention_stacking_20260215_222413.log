2026-02-15 22:24:13,261 - INFO - run_attention_stacking - ğŸš€ å¼€å§‹ stacking: base=attention, outputs=C:\Repositories\Traffic\FusionModel\outputs
2026-02-15 22:24:13,261 - INFO - fusion_common - åŠ è½½èåˆæ•°æ® - å›¾åƒç›®å½•: C:\Repositories\Traffic\FusionModel\dataset\USTC-TFC2016\image_data\Train, Pcapç›®å½•: C:\Repositories\Traffic\FusionModel\dataset\USTC-TFC2016\pcap_data\Train
2026-02-15 22:24:13,404 - INFO - fusion_common - èåˆç´¢å¼•ç¼“å­˜å‘½ä¸­: C:\Repositories\Traffic\FusionModel\dataset\USTC-TFC2016\image_data\Train\.fusion_index_cache_v1_crepositoriestrafficfusionmo_crepositoriestrafficfusionmo.json, æ ·æœ¬æ•°: 52338
2026-02-15 22:24:13,408 - INFO - fusion_common - èåˆæ•°æ®åŠ è½½å®Œæˆï¼Œç±»åˆ«æ•°: 10, æ ·æœ¬æ€»æ•°: 52338
2026-02-15 22:24:13,408 - INFO - fusion_common - åŠ è½½èåˆæ•°æ® - å›¾åƒç›®å½•: C:\Repositories\Traffic\FusionModel\dataset\USTC-TFC2016\image_data\Test, Pcapç›®å½•: C:\Repositories\Traffic\FusionModel\dataset\USTC-TFC2016\pcap_data\Test
2026-02-15 22:24:13,430 - INFO - fusion_common - èåˆç´¢å¼•ç¼“å­˜å‘½ä¸­: C:\Repositories\Traffic\FusionModel\dataset\USTC-TFC2016\image_data\Test\.fusion_index_cache_v1_crepositoriestrafficfusionmo_crepositoriestrafficfusionmo.json, æ ·æœ¬æ•°: 12982
2026-02-15 22:24:13,430 - INFO - fusion_common - èåˆæ•°æ®åŠ è½½å®Œæˆï¼Œç±»åˆ«æ•°: 10, æ ·æœ¬æ€»æ•°: 12982
2026-02-15 22:24:13,431 - INFO - fusion_common - åˆå§‹åŒ–èåˆæ¨¡å‹ï¼Œèåˆæ¨¡å¼: attention
2026-02-15 22:24:13,507 - INFO - fusion_common - CharBERT åŠ è½½æˆåŠŸ: C:\Repositories\Traffic\FusionModel\src\CharBERT\src
2026-02-15 22:24:13,510 - INFO - fusion_common - èåˆæ¨¡å‹åˆå§‹åŒ–å®Œæˆï¼Œåˆ†ç±»å¤´è®¾ç½®ä¸º 10 ä¸ªç±»åˆ«
2026-02-15 22:24:13,510 - INFO - fusion_common - å¼€å§‹è®­ç»ƒèåˆæ¨¡å‹
2026-02-15 22:24:13,510 - INFO - fusion_common - è®­ç»ƒå‚æ•° - Epochs: 32, Learning Rate: 0.001, Early Stopping Patience: 8
2026-02-15 22:24:13,510 - INFO - fusion_common - è®­ç»ƒç­–ç•¥ - class_balance: none, loss_type: ce, focal_gamma: 2.000, weight_decay: 0.000000, label_smoothing: 0.0000, early_stop_metric: val_loss, lr_scheduler: none, val_every: 1
2026-02-15 22:24:13,510 - INFO - fusion_common - DataLoaderå‚æ•° - train_batches: 818, val_batches: 203, batch_size: 64, num_workers: 4, pin_memory: True
2026-02-15 22:24:13,792 - INFO - fusion_common - Epoch 1/32
2026-02-15 22:29:33,775 - INFO - fusion_common - Epoch 1 ç»“æœ: è®­ç»ƒ Loss: 0.3411, è®­ç»ƒ Acc: 0.8757, è®­ç»ƒ F1: 0.8683 | éªŒè¯ Loss: 0.1716, éªŒè¯ Acc: 0.9460, éªŒè¯ F1: 0.9391
2026-02-15 22:29:33,840 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 0/8
2026-02-15 22:29:33,840 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-15 22:29:33,841 - INFO - fusion_common - Epoch 2/32
2026-02-15 22:31:49,470 - INFO - fusion_common - Epoch 2 ç»“æœ: è®­ç»ƒ Loss: 0.1384, è®­ç»ƒ Acc: 0.9511, è®­ç»ƒ F1: 0.9487 | éªŒè¯ Loss: 0.1152, éªŒè¯ Acc: 0.9613, éªŒè¯ F1: 0.9597
2026-02-15 22:31:49,541 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 0/8
2026-02-15 22:31:49,544 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-15 22:31:49,544 - INFO - fusion_common - Epoch 3/32
2026-02-15 22:34:03,661 - INFO - fusion_common - Epoch 3 ç»“æœ: è®­ç»ƒ Loss: 0.1158, è®­ç»ƒ Acc: 0.9583, è®­ç»ƒ F1: 0.9559 | éªŒè¯ Loss: 0.1131, éªŒè¯ Acc: 0.9638, éªŒè¯ F1: 0.9606
2026-02-15 22:34:03,741 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 0/8
2026-02-15 22:34:03,743 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-15 22:34:03,743 - INFO - fusion_common - Epoch 4/32
2026-02-15 22:36:18,034 - INFO - fusion_common - Epoch 4 ç»“æœ: è®­ç»ƒ Loss: 0.1005, è®­ç»ƒ Acc: 0.9641, è®­ç»ƒ F1: 0.9629 | éªŒè¯ Loss: 0.1040, éªŒè¯ Acc: 0.9671, éªŒè¯ F1: 0.9660
2026-02-15 22:36:18,122 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 0/8
2026-02-15 22:36:18,122 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-15 22:36:18,124 - INFO - fusion_common - Epoch 5/32
2026-02-15 22:38:49,287 - INFO - fusion_common - Epoch 5 ç»“æœ: è®­ç»ƒ Loss: 0.1098, è®­ç»ƒ Acc: 0.9621, è®­ç»ƒ F1: 0.9600 | éªŒè¯ Loss: 0.1007, éªŒè¯ Acc: 0.9686, éªŒè¯ F1: 0.9680
2026-02-15 22:38:49,309 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 0/8
2026-02-15 22:38:49,309 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-15 22:38:49,310 - INFO - fusion_common - Epoch 6/32
2026-02-15 22:40:56,524 - INFO - fusion_common - Epoch 6 ç»“æœ: è®­ç»ƒ Loss: 0.0819, è®­ç»ƒ Acc: 0.9700, è®­ç»ƒ F1: 0.9691 | éªŒè¯ Loss: 0.0998, éªŒè¯ Acc: 0.9690, éªŒè¯ F1: 0.9689
2026-02-15 22:40:56,525 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 1/8
2026-02-15 22:40:56,525 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-15 22:40:56,525 - INFO - fusion_common - Epoch 7/32
2026-02-15 22:43:14,376 - INFO - fusion_common - Epoch 7 ç»“æœ: è®­ç»ƒ Loss: 0.0815, è®­ç»ƒ Acc: 0.9709, è®­ç»ƒ F1: 0.9699 | éªŒè¯ Loss: 0.0817, éªŒè¯ Acc: 0.9770, éªŒè¯ F1: 0.9764
2026-02-15 22:43:14,486 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 0/8
2026-02-15 22:43:14,488 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-15 22:43:14,488 - INFO - fusion_common - Epoch 8/32
2026-02-15 22:45:18,930 - INFO - fusion_common - Epoch 8 ç»“æœ: è®­ç»ƒ Loss: 0.0803, è®­ç»ƒ Acc: 0.9713, è®­ç»ƒ F1: 0.9702 | éªŒè¯ Loss: 0.0859, éªŒè¯ Acc: 0.9744, éªŒè¯ F1: 0.9732
2026-02-15 22:45:18,933 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 1/8
2026-02-15 22:45:18,934 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-15 22:45:18,934 - INFO - fusion_common - Epoch 9/32
2026-02-15 22:47:42,891 - INFO - fusion_common - Epoch 9 ç»“æœ: è®­ç»ƒ Loss: 0.0785, è®­ç»ƒ Acc: 0.9724, è®­ç»ƒ F1: 0.9707 | éªŒè¯ Loss: 0.0852, éªŒè¯ Acc: 0.9729, éªŒè¯ F1: 0.9722
2026-02-15 22:47:42,893 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 2/8
2026-02-15 22:47:42,893 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-15 22:47:42,894 - INFO - fusion_common - Epoch 10/32
2026-02-15 22:49:29,569 - INFO - fusion_common - Epoch 10 ç»“æœ: è®­ç»ƒ Loss: 0.0923, è®­ç»ƒ Acc: 0.9680, è®­ç»ƒ F1: 0.9659 | éªŒè¯ Loss: 0.0823, éªŒè¯ Acc: 0.9748, éªŒè¯ F1: 0.9725
2026-02-15 22:49:29,569 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 3/8
2026-02-15 22:49:29,569 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-15 22:49:29,569 - INFO - fusion_common - Epoch 11/32
2026-02-15 22:51:33,904 - INFO - fusion_common - Epoch 11 ç»“æœ: è®­ç»ƒ Loss: 0.0645, è®­ç»ƒ Acc: 0.9770, è®­ç»ƒ F1: 0.9757 | éªŒè¯ Loss: 0.0832, éªŒè¯ Acc: 0.9787, éªŒè¯ F1: 0.9779
2026-02-15 22:51:33,905 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 4/8
2026-02-15 22:51:33,906 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-15 22:51:33,906 - INFO - fusion_common - Epoch 12/32
2026-02-15 22:53:57,794 - INFO - fusion_common - Epoch 12 ç»“æœ: è®­ç»ƒ Loss: 0.0693, è®­ç»ƒ Acc: 0.9745, è®­ç»ƒ F1: 0.9726 | éªŒè¯ Loss: 0.0830, éªŒè¯ Acc: 0.9780, éªŒè¯ F1: 0.9770
2026-02-15 22:53:57,795 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 5/8
2026-02-15 22:53:57,795 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-15 22:53:57,795 - INFO - fusion_common - Epoch 13/32
2026-02-15 22:56:10,513 - INFO - fusion_common - Epoch 13 ç»“æœ: è®­ç»ƒ Loss: 0.0622, è®­ç»ƒ Acc: 0.9774, è®­ç»ƒ F1: 0.9766 | éªŒè¯ Loss: 0.1293, éªŒè¯ Acc: 0.9693, éªŒè¯ F1: 0.9688
2026-02-15 22:56:10,514 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 6/8
2026-02-15 22:56:10,514 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-15 22:56:10,514 - INFO - fusion_common - Epoch 14/32
2026-02-15 22:58:30,721 - INFO - fusion_common - Epoch 14 ç»“æœ: è®­ç»ƒ Loss: 0.0855, è®­ç»ƒ Acc: 0.9706, è®­ç»ƒ F1: 0.9688 | éªŒè¯ Loss: 0.1319, éªŒè¯ Acc: 0.9669, éªŒè¯ F1: 0.9654
2026-02-15 22:58:30,724 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 7/8
2026-02-15 22:58:30,724 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-15 22:58:30,725 - INFO - fusion_common - Epoch 15/32
2026-02-15 23:00:50,623 - INFO - fusion_common - Epoch 15 ç»“æœ: è®­ç»ƒ Loss: 0.0624, è®­ç»ƒ Acc: 0.9772, è®­ç»ƒ F1: 0.9764 | éªŒè¯ Loss: 0.0812, éªŒè¯ Acc: 0.9777, éªŒè¯ F1: 0.9765
2026-02-15 23:00:50,670 - INFO - fusion_common - æ—©åœè®¡æ•°å™¨: 8/8
2026-02-15 23:00:50,670 - INFO - fusion_common - å½“å‰å­¦ä¹ ç‡: 0.00100000
2026-02-15 23:00:50,670 - INFO - fusion_common - æ—©åœæœºåˆ¶è§¦å‘ï¼Œåœ¨ç¬¬ 15 è½®ååœæ­¢è®­ç»ƒ
2026-02-15 23:00:50,706 - INFO - fusion_common - âœ… å·²æ¢å¤æœ€ä½³éªŒè¯æƒé‡: metric=val_loss, best_score=0.081723, mode=min
2026-02-15 23:00:50,708 - INFO - fusion_common - èåˆæ¨¡å‹è®­ç»ƒå®Œæˆ
2026-02-15 23:00:53,370 - INFO - run_attention_stacking - [AttentionDiag] mean=0.001276 min=0.000001 max=0.012680 entropy=5.7065 top1=0.0075 top5=0.0349 top10=0.0662 nonpad_mass=1.0000 pad_mass=0.0000 nonpad_frac=1.0000
2026-02-15 23:00:54,646 - INFO - run_attention_stacking - [AttentionDiag] saved attention curve: C:\Repositories\Traffic\FusionModel\outputs\attention_curve_attention_stacking_20260215_222413.png
2026-02-15 23:00:54,835 - INFO - run_attention_stacking - âœ… å·²ä¿å­˜ metrics_curve_attention_stacking: C:\Repositories\Traffic\FusionModel\outputs\metrics_curve_attention_stacking_20260215_222413.png (exists=True)
2026-02-15 23:04:06,473 - INFO - run_attention_stacking - ğŸ“Š [attention_stacking_xgboost] acc=0.9802 macro_f1=0.9796
2026-02-15 23:04:06,474 - INFO - run_attention_stacking - [attention_stacking_xgboost] åˆ†ç±»æŠ¥å‘Š:
              precision    recall  f1-score   support

           0     1.0000    0.9994    0.9997      1648
           1     0.9957    0.9935    0.9946      1393
           2     0.9841    0.9876    0.9859      1130
           3     0.9952    0.9856    0.9904       209
           4     0.9322    0.9285    0.9304      1511
           5     0.9865    0.9765    0.9815      1194
           6     0.9995    0.9970    0.9982      1968
           7     1.0000    0.9988    0.9994      1657
           8     0.9071    0.9305    0.9186      1165
           9     0.9982    0.9955    0.9968      1107

    accuracy                         0.9802     12982
   macro avg     0.9798    0.9793    0.9796     12982
weighted avg     0.9804    0.9802    0.9803     12982

2026-02-15 23:04:06,474 - INFO - run_attention_stacking - [attention_stacking_xgboost] æ··æ·†çŸ©é˜µ:
[[1647    0    1    0    0    0    0    0    0    0]
 [   0 1384    6    1    1    0    1    0    0    0]
 [   0    2 1116    0    8    2    0    0    2    0]
 [   0    0    0  206    3    0    0    0    0    0]
 [   0    3    5    0 1403    8    0    0   91    1]
 [   0    0    3    0   14 1166    0    0   11    0]
 [   0    0    2    0    2    0 1962    0    2    0]
 [   0    0    0    0    0    0    0 1655    1    1]
 [   0    1    1    0   73    6    0    0 1084    0]
 [   0    0    0    0    1    0    0    0    4 1102]]
2026-02-15 23:04:07,266 - INFO - run_attention_stacking - âœ… å·²ä¿å­˜ confusion_matrix_attention_stacking_xgboost: C:\Repositories\Traffic\FusionModel\outputs\confusion_matrix_attention_stacking_xgboost_20260215_222413.png (exists=True)
2026-02-15 23:04:07,269 - INFO - run_attention_stacking - âœ… å·²ä¿å­˜ report_attention_stacking_xgboost: C:\Repositories\Traffic\FusionModel\outputs\report_attention_stacking_xgboost_20260215_222413.md (exists=True)
2026-02-15 23:04:07,303 - INFO - run_attention_stacking - âœ… å·²ä¿å­˜ meta_model_attention_stacking_xgboost: C:\Repositories\Traffic\FusionModel\outputs\meta_model_attention_stacking_xgboost.pkl (exists=True)
2026-02-15 23:04:07,514 - INFO - run_attention_stacking - âœ… å·²ä¿å­˜ model_attention_stacking_base: C:\Repositories\Traffic\FusionModel\outputs\fusion_model_attention_stacking_base.pth (exists=True)
2026-02-15 23:04:07,515 - INFO - run_attention_stacking - ğŸ stacking å®Œæˆ, log=C:\Repositories\Traffic\FusionModel\outputs\logs\attention_stacking_20260215_222413.log
